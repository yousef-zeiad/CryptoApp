import { ExpoRequest, ExpoResponse } from "expo-router/server";

const API_KEY = process.env.CRYPTO_API_KEY;

export async function GET(request: ExpoRequest) {
  const limit = request.expoUrl.searchParams.get("limit") || 15;

  const response = await fetch(
    `https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest?start=1&limit=${limit}&convert=USD`,
    {
      headers: {
        "X-CMC_PRO_API_KEY": API_KEY!,
      },
    }
  );
  const res = await response.json();
  return ExpoResponse.json(res.data);
}
const data = [
  {
    id: 1,
    name: "Bitcoin",
    symbol: "BTC",
    slug: "bitcoin",
    num_market_pairs: 11024,
    date_added: "2010-07-13T00:00:00.000Z",
    tags: [
      "mineable",
      "pow",
      "sha-256",
      "store-of-value",
      "state-channel",
      "coinbase-ventures-portfolio",
      "three-arrows-capital-portfolio",
      "polychain-capital-portfolio",
      "binance-labs-portfolio",
      "blockchain-capital-portfolio",
      "boostvc-portfolio",
      "cms-holdings-portfolio",
      "dcg-portfolio",
      "dragonfly-capital-portfolio",
      "electric-capital-portfolio",
      "fabric-ventures-portfolio",
      "framework-ventures-portfolio",
      "galaxy-digital-portfolio",
      "huobi-capital-portfolio",
      "alameda-research-portfolio",
      "a16z-portfolio",
      "1confirmation-portfolio",
      "winklevoss-capital-portfolio",
      "usv-portfolio",
      "placeholder-ventures-portfolio",
      "pantera-capital-portfolio",
      "multicoin-capital-portfolio",
      "paradigm-portfolio",
      "bitcoin-ecosystem",
      "ftx-bankruptcy-estate",
    ],
    max_supply: 21000000,
    circulating_supply: 19694840,
    total_supply: 19694840,
    infinite_supply: false,
    platform: null,
    cmc_rank: 1,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: "2024-05-06T17:51:00.000Z",
    quote: {
      USD: {
        price: 63106.729226033094,
        volume_24h: 26961417043.06096,
        volume_change_24h: 45.0065,
        percent_change_1h: -0.37283944,
        percent_change_24h: -1.80370006,
        percent_change_7d: 0.17746416,
        percent_change_30d: -7.60353547,
        percent_change_60d: -7.00480194,
        percent_change_90d: 46.07721262,
        market_cap: 1242876935030.0457,
        market_cap_dominance: 53.3735,
        fully_diluted_market_cap: 1325241313746.69,
        tvl: null,
        last_updated: "2024-05-06T17:51:00.000Z",
      },
    },
  },
  {
    id: 1027,
    name: "Ethereum",
    symbol: "ETH",
    slug: "ETH",
    num_market_pairs: 8898,
    date_added: "2015-08-07T00:00:00.000Z",
    tags: [
      "pos",
      "smart-contracts",
      "ethereum-ecosystem",
      "coinbase-ventures-portfolio",
      "three-arrows-capital-portfolio",
      "polychain-capital-portfolio",
      "binance-labs-portfolio",
      "blockchain-capital-portfolio",
      "boostvc-portfolio",
      "cms-holdings-portfolio",
      "dcg-portfolio",
      "dragonfly-capital-portfolio",
      "electric-capital-portfolio",
      "fabric-ventures-portfolio",
      "framework-ventures-portfolio",
      "hashkey-capital-portfolio",
      "kenetic-capital-portfolio",
      "huobi-capital-portfolio",
      "alameda-research-portfolio",
      "a16z-portfolio",
      "1confirmation-portfolio",
      "winklevoss-capital-portfolio",
      "usv-portfolio",
      "placeholder-ventures-portfolio",
      "pantera-capital-portfolio",
      "multicoin-capital-portfolio",
      "paradigm-portfolio",
      "injective-ecosystem",
      "layer-1",
      "ftx-bankruptcy-estate",
    ],
    max_supply: null,
    circulating_supply: 120099596.60210653,
    total_supply: 120099596.60210653,
    infinite_supply: true,
    platform: null,
    cmc_rank: 2,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: "2024-05-06T17:50:00.000Z",
    quote: {
      USD: {
        price: 3069.289576789998,
        volume_24h: 12313811110.96636,
        volume_change_24h: 37.9012,
        percent_change_1h: -0.33836812,
        percent_change_24h: -2.59617474,
        percent_change_7d: -3.21340984,
        percent_change_30d: -8.20652042,
        percent_change_60d: -20.75061775,
        percent_change_90d: 30.35856664,
        market_cap: 368620440027.52905,
        market_cap_dominance: 15.8299,
        fully_diluted_market_cap: 368620440027.53,
        tvl: null,
        last_updated: "2024-05-06T17:50:00.000Z",
      },
    },
  },
  {
    id: 825,
    name: "Tether USDt",
    symbol: "USDT",
    slug: "tether",
    num_market_pairs: 84743,
    date_added: "2015-02-25T00:00:00.000Z",
    tags: [
      "stablecoin",
      "asset-backed-stablecoin",
      "avalanche-ecosystem",
      "solana-ecosystem",
      "arbitrum-ecosytem",
      "moonriver-ecosystem",
      "injective-ecosystem",
      "bnb-chain",
      "usd-stablecoin",
      "optimism-ecosystem",
    ],
    max_supply: null,
    circulating_supply: 110906825432.78822,
    total_supply: 113086550461.48636,
    platform: {
      id: 1027,
      name: "Ethereum",
      symbol: "ETH",
      slug: "ethereum",
      token_address: "0xdac17f958d2ee523a2206206994597c13d831ec7",
    },
    infinite_supply: true,
    cmc_rank: 3,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: "2024-05-06T17:50:00.000Z",
    quote: {
      USD: {
        price: 1.0003003599232343,
        volume_24h: 50805512705.18042,
        volume_change_24h: 39.3039,
        percent_change_1h: 0.00752826,
        percent_change_24h: 0.01426765,
        percent_change_7d: 0.03469035,
        percent_change_30d: 0.01913921,
        percent_change_60d: -0.10514183,
        percent_change_90d: 0.07950267,
        market_cap: 110940137398.36137,
        market_cap_dominance: 4.7642,
        fully_diluted_market_cap: 113120517129.1,
        tvl: null,
        last_updated: "2024-05-06T17:50:00.000Z",
      },
    },
  },
  {
    id: 1839,
    name: "BNB",
    symbol: "BNB",
    slug: "bnb",
    num_market_pairs: 2154,
    date_added: "2017-07-25T00:00:00.000Z",
    tags: [
      "marketplace",
      "centralized-exchange",
      "payments",
      "smart-contracts",
      "alameda-research-portfolio",
      "multicoin-capital-portfolio",
      "bnb-chain",
      "layer-1",
      "sec-security-token",
      "alleged-sec-securities",
      "celsius-bankruptcy-estate",
    ],
    max_supply: null,
    circulating_supply: 147587321.9974061,
    total_supply: 147587321.9974061,
    infinite_supply: false,
    platform: null,
    cmc_rank: 4,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: "2024-05-06T17:50:00.000Z",
    quote: {
      USD: {
        price: 587.2134911925298,
        volume_24h: 1489986055.5268376,
        volume_change_24h: 173.7573,
        percent_change_1h: -0.01762872,
        percent_change_24h: -0.90509356,
        percent_change_7d: -0.81267883,
        percent_change_30d: 0.34362537,
        percent_change_60d: 28.69805592,
        percent_change_90d: 94.02685329,
        market_cap: 86665266605.85287,
        market_cap_dominance: 3.7217,
        fully_diluted_market_cap: 86665266605.85,
        tvl: null,
        last_updated: "2024-05-06T17:50:00.000Z",
      },
    },
  },
  {
    id: 5426,
    name: "Solana",
    symbol: "SOL",
    slug: "solana",
    num_market_pairs: 656,
    date_added: "2020-04-10T00:00:00.000Z",
    tags: [
      "pos",
      "platform",
      "solana-ecosystem",
      "cms-holdings-portfolio",
      "kenetic-capital-portfolio",
      "alameda-research-portfolio",
      "multicoin-capital-portfolio",
      "okx-ventures-portfolio",
      "layer-1",
      "ftx-bankruptcy-estate",
      "sec-security-token",
      "alleged-sec-securities",
      "cmc-crypto-awards-2024",
    ],
    max_supply: null,
    circulating_supply: 447435680.81156695,
    total_supply: 575388688.0395123,
    infinite_supply: true,
    platform: null,
    cmc_rank: 5,
    self_reported_circulating_supply: null,
    self_reported_market_cap: null,
    tvl_ratio: null,
    last_updated: "2024-05-06T17:50:00.000Z",
    quote: {
      USD: {
        price: 151.30624643305887,
        volume_24h: 2665894855.448951,
        volume_change_24h: 10.2191,
        percent_change_1h: -0.55455221,
        percent_change_24h: 3.06609642,
        percent_change_7d: 12.01753285,
        percent_change_30d: -14.86561446,
        percent_change_60d: 2.87536951,
        percent_change_90d: 58.0924077,
        market_cap: 67699813383.81842,
        market_cap_dominance: 2.9034,
        fully_diluted_market_cap: 87059902627.3,
        tvl: null,
        last_updated: "2024-05-06T17:50:00.000Z",
      },
    },
  },
];
